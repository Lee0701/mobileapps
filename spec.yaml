swagger: '2.0'

info:
  version: 0.1.0
  title: WMF MobileApps service
  description: A prototype for MediaWiki REST API services for mobile apps
  termsOfService: https://wikimediafoundation.org/wiki/Terms_of_Use
  contact:
    name: the Wikimedia Reading team
    url: http://mediawiki.org/wiki/Reading
  license:
    name: Apache2
    url: http://www.apache.org/licenses/LICENSE-2.0

x-default-params:
  domain: en.wikipedia.org

paths:
  # from routes/root.js
  /robots.txt:
    get:
      tags:
        - Root
        - Robots
      description: Gets robots.txt
      x-monitor: false

  /:
    get:
      tags:
        - Root
      description: The root service end-point
      produces:
        - application/json
      x-amples:
        - title: spec from root
          request:
            query:
              spec: true
          response:
            status: 200

  # from routes/info.js
  /_info:
    get:
      tags:
        - Service information
      description: Gets information about the service
      produces:
        - application/json
      x-amples:
        - title: retrieve service info
          request: {}
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              name: /.+/
              description: /.+/
              version: /.+/
              home: /.+/

  # from routes/announcements.js
  /{domain}/v1/feed/announcements:
    get:
      tags:
        - Announcements for apps
      description: Gets announcements for display in the official Wikipedia iOS and Android apps
      produces:
        - application/json
      responses:
        '200':
          description: Announcements for the given Wiki
          schema:
            $ref: '$/definitions/announcements'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: Retrieve announcements
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              announce:
                - id: /.+/
                  type: /.+/
                  start_time: /.+/
                  end_time: /.+/
                  platforms: [ /.+/ ]
                  text: /.+/
                  action:
                    title: /.+/
                    url: /.+/
                  caption_HTML: /.+/
                  countries: [ /.+/ ]

  # from routes/compilations.js
  /{domain}/v1/compilations:
    get:
      tags:
        - Offline compilations
      description: Gets information about the offline compilations available for download
      produces:
        - application/json
      responses:
        '200':
          description: Offline compilation information
          schema:
            $ref: '$/definitions/compilations'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: Offline compilations
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              compilations: []

  # from routes/on-this-day.js
  /{domain}/v1/feed/onthisday/{type}/{mm}/{dd}:
    get:
      tags:
        - Feed
      description: |
        Provides events that historically happened on the provided day and month.
        Supported types of events are:
         - All: all of the following
         - Selected: a list of a few selected anniversaries which happen on the provided day and month; often the entries are curated for the current year
         - Births: a list of birthdays which happened on the provided day and month
         - Deaths: a list of deaths which happened on the provided day and month
         - Holidays: a list of fixed holidays celebrated on the provided day and month
         - Events: a list of significant events which happened on the provided day and month and which are not covered by the other types yet
      produces:
        - application/json
      parameters:
        - name: type
          in: path
          description: "type of events"
          type: string
          required: true
          enum:
            - all
            - selected
            - births
            - deaths
            - holidays
            - events
        - name: mm
          in: path
          description: "Month events are requested for, 0-padded"
          type: string
          required: true
          minimum: "01"
          maximum: "12"
        - name: dd
          in: path
          description: "Day of the month the most-read articles are requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "31"
      responses:
        '200':
          description: Annual events listed on this wiki for the requested month and day
          schema:
            $ref: '#/definitions/onthisdayResponse'
        '404':
          description: No data found for the requested date
          schema:
            $ref: '#/definitions/problem'
        '501':
          description: Unsupported language
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: retrieve all events on January 15
          request:
            params:
              type: "all"
              mm: "01"
              dd: "15"
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              selected:
                - text: /.+/
                  year: /.+/
                  pages:
                    - $merge: [ /.+/ ]
              events:
                - text: /.+/
                  year: /.+/
                  pages:
                    - $merge: [ /.+/ ]
              births:
                - text: /.+/
                  year: /.+/
                  pages:
                    - $merge: [ /.+/ ]
              deaths:
                - text: /.+/
                  year: /.+/
                  pages:
                    - $merge: [ /.+/ ]
              holidays:
                - text: /.+/
                  pages:
                    - $merge: [ /.+/ ]
        - title: retrieve the selected anniversaries for January 15
          request:
            params:
              type: "selected"
              mm: "01"
              dd: "15"
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              selected:
                - text: /.+/
                  year: /.+/
                  pages:
                    - $merge: [ /.+/ ]

  # from routes/featured.js
  /{domain}/v1/page/featured/{yyyy}/{mm}/{dd}:
    get:
      tags:
        - Featured article for a given date
      description: title of the featured article (only works on enwiki for now)
      produces:
        - application/json
      parameters:
        - name: yyyy
          in: path
          description: "Year the featured article is requested for"
          type: string
          required: true
          minimum: "2016"
          maximum: "2999"
        - name: mm
          in: path
          description: "Month the featured article is requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "12"
        - name: dd
          in: path
          description: "Day of the month the featured article is requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "31"
      responses:
        '200':
          description: The title of a Wikipedia's Featured Article of the Day
          schema:
            $ref: '#/definitions/article_summary_merge_link'
        '204':
          description: Empty response (for feed content aggregation requests from RESTBase)
          schema:
            $ref: '#/definitions/empty'
        '404':
          description: Not found
          schema:
            $ref: '#/definitions/problem'
        '500':
          description: API Error
          schema:
            $ref: '#/definitions/problem'
        '501':
          description: Unsupported language
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: retrieve title of the featured article for April 29, 2016
          request:
            params:
              yyyy: "2016"
              mm: "04"
              dd: "29"
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              $merge: [ /.+/ ]
        - title: retrieve featured article info for unsupported site (with aggregated=true)
          request:
            params:
              domain: "is.wikipedia.org"
              yyyy: "2016"
              mm: "04"
              dd: "29"
            query:
              aggregated: true
          response:
            status: 204
            body: ""

  # from routes/featured-image.js
  /{domain}/v1/media/image/featured/{yyyy}/{mm}/{dd}:
    get:
      tags:
        - Featured image for a given date (aka Picture of the day)
      description: Provides thumbnail and full res image URLs and a localized description based on the domain used.
      produces:
        - application/json
      parameters:
        - name: yyyy
          in: path
          description: "Year the featured image is requested for"
          type: string
          required: true
          minimum: "2016"
          maximum: "2999"
        - name: mm
          in: path
          description: "Month the featured image is requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "12"
        - name: dd
          in: path
          description: "Day of the month the featured image is requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "31"
      responses:
        '200':
          description: Info on the Commons Featured Image of the Day for the requested date
          schema:
            $ref: '#/definitions/image'
        '204':
          description: Empty response (for feed content aggregation requests from RESTBase)
          schema:
            $ref: '#/definitions/empty'
        '404':
          description: Not found (no featured image for the requested date)
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: retrieve featured image data for April 29, 2016
          request:
            params:
              yyyy: "2016"
              mm: "04"
              dd: "29"
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              title: /.+/
              description: # Description
                text: /.+/
                lang: /.+/
              image:
                source: /.+/
                width: /.+/
                height: /.+/
              thumbnail:
                source: /.+/
                width: /.+/
                height: /.+/

  # from routes/most-read.js
  /{domain}/v1/page/most-read/{yyyy}/{mm}/{dd}:
    get:
      tags:
        - Most-read articles
      description: Gets the most-read articles for the date provided
      produces:
        - application/json
      parameters:
        - name: yyyy
          in: path
          description: "Year the most-read articles are requested for"
          type: string
          required: true
          minimum: "2016"
          maximum: "2999"
        - name: mm
          in: path
          description: "Month the most-read articles are requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "12"
        - name: dd
          in: path
          description: "Day of the month the most-read articles are requested for"
          type: string
          required: true
          minimum: "01"
          maximum: "31"
      responses:
        '200':
          description: Most-read article titles for this wiki for the requested date
          schema:
            $ref: '#/definitions/mostread'
        '204':
          description: Empty response (for feed content aggregation requests from RESTBase)
          schema:
            $ref: '#/definitions/empty'
        '404':
          description: No data found for the requested date
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: retrieve the most-read articles for January 1, 2016
          request:
            params:
              yyyy: "2016"
              mm: "01"
              dd: "01"
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              date: "2016-01-01Z"
              articles:
                - views: /.+/
                  rank: /.+/
                  $merge: [ /.+/ ]
        - title: retrieve the most-read articles for January 1, 2016 (with aggregated=true)
          request:
            params:
              yyyy: "2016"
              mm: "01"
              dd: "01"
            query:
              aggregated: true
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              date: "2015-12-31Z"
              articles:
                - views: /.+/
                  rank: /.+/
                  $merge: [ /.+/ ]
        - title: retrieve most-read articles for date with no data (with aggregated=true)
          request:
            params:
              yyyy: "2015"
              mm: "01"
              dd: "01"
            query:
              aggregated: true
          response:
            status: 204
            body: ""

  # from routes/random.js
  /{domain}/v1/page/random/title:
    get:
      tags:
        - Random article title
      description: Gets the title of a randomly picked article from main namespace. Preference is given to articles with a thumbnail, long extract, and an associated Wikidata description.
      produces:
        - application/json
      responses:
        '200':
          description: A random (good) article title
          schema:
            $ref: '#/definitions/random'
        '400':
          description: Bad request
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: retrieve a random article
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              items:
                - title: /.+/

  # from routes/news.js
  /{domain}/v1/page/news:
    get:
      tags:
        - News-related content
      description: Gets content related to the current In the News template (experimental, English-only).
      produces:
        - application/json
      responses:
        '200':
          description: News content from the a Wikipedia main page
          schema:
            $ref: '#/definitions/news'
        '204':
          description: Empty response (for feed content aggregation requests from RESTBase)
          schema:
            $ref: '#/definitions/empty'
        '501':
          description: Unsupported language
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: get 'In the News' content
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              - story: /.+/
                links:
                  - $merge: [ /.+/ ]
        - title: get 'In the News' content for unsupported language (with aggregated=true)
          request:
            params:
              domain: "is.wikipedia.org"
            query:
              aggregated: true
          response:
            status: 204
            body: ""

  # from routes/media.js
  /{domain}/v1/page/media/{title}:
    get:
      tags:
        - Media items on a given page
      description: Gets the media items (images, audio, and video) which appear on a given wiki page
      produces:
        - application/json
      responses:
        '200':
          description: Gets media items from a wiki page
          schema:
            $ref: '#/definitions/media_list'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: retrieve media items of en.wp Cat page via media route
          request:
            params:
              title: Cat
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              items:
                - title: /.+/
                  type: /.+/
                  url: /.+/
                  mime: /.+/
                  thumb_url: /.+/
                  thumb_mime: /.+/
                  width: /.+/
                  height: /.+/
                  size: /.+/
                  license: /.+/

  # from routes/definition.js
  /{domain}/v1/page/definition/{title}:
    get:
      tags:
        - Wiktionary definition of {title}
      description: Gets definitions parsed from Wiktionary for {title}
      produces:
        - application/json
      x-amples:
        - title: retrieve en-wiktionary definitions for 'cat'
          request:
            params:
              domain: en.wiktionary.org
              title: cat
          response:
            status: 200
            headers:
              content-type: application/json
            body: /.+/

  # from routes/mobile-sections.js
  /{domain}/v1/page/summary/{title}{/revision}{/tid}:
    get:
      tags:
        - Page content
      summary: Get a text extract of a page.
      description: |
        The summary response includes an extract of the first paragraph of the page in plain text
        and HTML as well as the type of page. This is useful for page previews.

        Stability: [unstable](https://www.mediawiki.org/wiki/API_versioning#Unstable)
      produces:
        - application/json; charset=utf-8; profile="https://www.mediawiki.org/wiki/Specs/Summary/1.2.0"
      parameters:
        - name: title
          in: path
          description: "Page title. Use underscores instead of spaces. Example: `Main_Page`."
          type: string
          required: true
        - name: revision
          in: path
          description: "Revision of page content"
          type: integer
          required: false
        - name: tid
          in: path
          description: "Time UUID of requested summary render"
          type: string
          required: false
      responses:
        '200':
          description: The summary for the given page
          schema:
            $ref: '#/definitions/summary'
          headers:
            ETag:
              description: >
                Syntax: "{revision}/{tid}".
                Example: "701384379/154d7bca-c264-11e5-8c2f-1b51b33b59fc"
        '404':
          description: Unknown page title or revision
          schema:
            $ref: '#/definitions/problem'
        default:
          description: Error
          schema:
            $ref: '#/definitions/problem'
      x-amples:
        - title: Get summary for Barack Obama
          request:
            params:
              domain: en.wikipedia.org
              title: Barack_Obama
          response:
            status: 200
            headers:
              etag: /.+/
              content-type: /^application\/json/
            body:
              type: standard
              title: /.+/
              displaytitle: /.+/
              namespace:
                id: /.+/
                text: /.*/
              titles:
                canonical: /.+/
                normalized: /.+/
                display: /.+/
              pageid: /.+/
              thumbnail:
                source: /.+/
                width: /.+/
                height: /.+/
              originalimage:
                source: /.+/
                width: /.+/
                height: /.+/
              lang: /.+/
              dir: /.+/
              revision: /.+/
              tid: /.+/
              timestamp: /.+/
              description: /.+/
              content_urls:
                desktop:
                  page: /.+/
                  revisions: /.+/
                  edit: /.+/
                  talk: /.+/
                mobile:
                  page: /.+/
                  revisions: /.+/
                  edit: /.+/
                  talk: /.+/
              api_urls:
                summary: /.+/
#                read_html: /.+/
#                content_html: /.+/
#                metadata: /.+/
#                references: /.+/
#                media: /.+/
                edit_html: /.+/
                talk_page_html: /.+/
              extract: /.+/
              extract_html: /.+/

  # from routes/mobile-sections.js
  /{domain}/v1/page/mobile-sections/{title}:
    get:
      tags:
        - Page content
      description: Gets the full page content of a given wiki page for mobile apps
      produces:
        - application/json
      x-amples:
        - title: retrieve en.wp main page via mobile-sections
          request:
            params:
              title: Main_Page
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              lead:
                id: /.+/
                revision: /.+/
                lastmodified: /.+/
                lastmodifier: /.+/
                displaytitle: /.+/
                normalizedtitle: /.+/
                wikibase_item: Q5296
                protection: /.+/
                editable: /.+/
                mainpage: true
                languagecount: /.+/
                ns: /.+/
                sections: [ /.+/ ]
              remaining:
                sections: []

  /{domain}/v1/page/mobile-sections-lead/{title}:
    get:
      tags:
        - Lead section of page content
      description: Gets the lead section and general metadata of a given wiki page for mobile apps
      produces:
        - application/json
      x-amples:
        - title: retrieve lead section of en.wp Altrincham page via mobile-sections-lead
          request:
            params:
              title: Altrincham
          response:
            status: 200
            headers:
              content-type: application/json
            body:
              id: /.+/
              revision: /.+/
              lastmodified: /.+/
              lastmodifier: /.+/
              displaytitle: /.+/
              wikibase_item: Q445058
              description: /.+/
              hatnotes: /.+/
              protection: /.+/
              editable: /.+/
              languagecount: /.+/
              ns: /.+/
              pronunciation:
                url: /.+/
              spoken:
                files: [ /.+/ ]
              geo:
                latitude: /.+/
                longitude: /.+/
              sections: [ /.+/ ]

  /{domain}/v1/page/mobile-sections-remaining/{title}:
    get:
      tags:
        - Lead section of page content
      description: Gets the remaining sections of a given wiki page for mobile apps
      produces:
        - application/json
      x-monitor: false

definitions:
  # A https://tools.ietf.org/html/draft-nottingham-http-problem
  problem:
    required:
      - type
    properties:
      status:
        type: integer
      type:
        type: string
      title:
        type: string
      detail:
        type: string
      method:
        type: string
      uri:
        type: string

  article_title:
    type: object
    properties:
      title:
        type: string
        description: An article title
    required:
      - title

  article_summary_merge_link:
    type: object
    properties:
      $merge:
        type: array
        description: One-element array containing the link to the RESTBase summary for the article
        items:
          type: string
    required:
      - $merge

  image_props:
    type: object
    properties:
      source:
        type: string
        description: URI
      width:
        type: integer
        minimum: 0
        description: width (px)
      height:
        type: integer
        minimum: 0
        description: height (px)
    required:
      - source
      - width
      - height

  # see also RB v1/common_schemas.yaml
  summary:
    type: object
    properties:
      type:
        type: string
        description: Type of page summary
        enum:
          - standard
      title:
        type: string
        description: The page title
      displaytitle:
        type: string
        description: The page title how it should be shown to the user
      namespace:_id:
        type: object
        properties:
          id:
            type: integer
            description: the numeric ID for the page's namespace (https://www.mediawiki.org/wiki/Manual:Namespace)
          text:
            type: string
            description: localized text name for the MediaWiki namespace
        required: [ id, text ]
        additionalProperties: false
      titles:
        $ref: '#/definitions/titles_set'
      pageid:
        type: integer
        description: The page ID
      revision:
        type: string
        description: The revision of the page when the summary was produced
      tid:
        type: string
        description: The timeuuid associated with the underlying HTML content
      extract:
        type: string
        description: First several sentences of an article in plain text
      extract_html:
        type: string
        description: First several sentences of an article in simple HTML format
      thumbnail:
        $ref: '#/definitions/image_props'
      originalimage:
        $ref: '#/definitions/image_props'
      lang:
        type: string
        description: The page language code
        example: en
      dir:
        type: string
        description: The page language direction code
        enum:
          - ltr
          - rtl
      timestamp:
        type: string
        format: date-time
        description: The time when the page was last editted in the [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) format
        example: '1970-01-01T00:00:00.000Z'
      description:
        type: string
        description: Wikidata description for the page
        example: American poet
      content_urls:
        desktop:
          $ref: '#/definitions/content_urls'
        mobile:
          $ref: '#/definitions/content_urls'
      api_urls:
        $ref: '#/definitions/api_urls'
      coordinates:
        type: object
        description: The coordinates of the item
        properties:
          lat:
            type: number
            description: The latitude
          lon:
            type: number
            description: The longitude
        requiredProperties: [ 'lat', 'lon' ]
    required:
      - type
      - title
      - displaytitle
      - pageid
      - lang
      - dir
      - revision
      - timestamp
      - content_urls
      - api_urls
      - extract
      - extract_html

  dated_pageview:
    type: object
    date:
      type: string
      description: ISO 8601 timestamp of pageviews recorded
    views:
      type: integer
      description: Number of views on date

  mostread_article:
    type: object
    properties:
      $merge:
        type: array
        description: One-element array containing the link to the RESTBase summary for the article
        items:
          type: string
      views:
        type: integer
        description: Number of views on the requested day
      view_history:
        type: array
        items:
          $ref: '#/definitions/dated_pageview'
      rank:
        type: integer
        description: Position in the list of most viewed articles
    required:
      - $merge
      - views
      - rank

  mostread:
    type: object
    properties:
      date:
        type: string
        description: The date which the data correspond to
      articles:
        type: array
        description: Array of most popular articles
        items:
          $ref: '#/definitions/mostread_article'
    required:
      - date
      - articles

  onthisdayList:
    type: array
    items:
      type: object
      properties:
        text:
          type: string
          description: Short description of the event
        year:
          type: integer
          description: The year this event occurred
        pages:
          type: array
          description: List of pages related to the event
          items:
            $ref: '#/definitions/article_summary_merge_link'
    required:
      - text
      - pages

  onthisdayResponse:
    type: object
    description: Lists of events which happened on the provided day and month
    properties:
      births:
        description: A list of birthdays which happened on the provided day and month
        $ref: '#/definitions/onthisdayList'
      deaths:
        description: A list of deaths which happened on the provided day and month
        $ref: '#/definitions/onthisdayList'
      events:
        description: A list of significant events which happened on the provided day and month and which are not covered by the other types yet
        $ref: '#/definitions/onthisdayList'
      holidays:
        description: A list of fixed holidays celebrated on the provided day and month
        $ref: '#/definitions/onthisdayList'
      selected:
        description: A list of a few selected anniversaries which occur on the provided day and month; often the entries are curated for the current year
        $ref: '#/definitions/onthisdayList'
    additionalProperties: false

  news_item:
    type: object
    properties:
      story:
        type: string
        description: A cover story for the news item
      links:
        type: array
        description: A collection of pages mentioned in the headline. The first page is the headline topic
        items:
          $ref: '#/definitions/article_summary_merge_link'
    required:
      - story
      - links

  news:
    type: array
    items:
      $ref: '#/definitions/news_item'

  random:
    type: object
    properties:
      items:
        type: array
        items:
          $ref: '#/definitions/article_title'
    required:
      - items

  image_description:
    properties:
      text:
        type: string
        description: Text of the description
      lang:
        type: string
        description: Language code of the description
    required:
      - text
      - lang

  image:
    type: object
    properties:
      title:
        type: string
        description: Image title
      thumbnail:
        description: Image thumbnail
        $ref: '#/definitions/image_props'
      image:
        description: Full-size image
        $ref: '#/definitions/image_props'
      description:
        description: Description of an image
        $ref: '#/definitions/image_description'
    required:
      - title
      - thumbnail
      - image

  announcements:
    type: object
    properties:
      announce:
        type: array
        description: list of active announcements for this wiki
        items:
          $ref: '#/definitions/announcement'
    required:
      - announce

  announcement:
    type: object
    properties:
      id:
        type: string
        description: Unique ID of the announcement
      type:
        type: string
        description: The type of announcement. Possible values are "survey" or "fundraising"
      start_time:
        type: string
        description: The date to begin showing the announcement
      end_time:
        type: string
        description: The date to stop showing the announcement
      platforms:
        type: array
        description: An array of platforms to display the announcement. Possible values are "iOSApp" or "AndroidApp"
        items:
          type: string
      text:
        type: string
        description: The text of the announcement
      image:
        type: string
        description: The URL of the image for the announcement
      image_url:
        type: string
        description: The URL of the image for the announcement (iOS App specific)
      action:
        type: object
        description: The action for the button of the announcement
        schema:
          $ref: '#/definitions/action'
      caption_HTML:
        type: string
        description: HTML to display below the announcement. Usually a privacy statment and link to a policy
      countries:
        type: array
        description: An array of country codes in which to display the announcement. Clients should derive the country from 'GeoIP' portion of the Set-Cookie header
        items:
          type: string
    required:
      - id
      - type
      - start_time
      - end_time
      - platforms
      - text
      - countries

  compilations:
    type: object
    properties:
      compilations:
        type: array
        description: list of available offline article compilations
        items:
          $ref: '#/definitions/compilation'
    required:
      - compilations

  compilation:
    type: object
    properties:
      name:
        type: string
        description: The name of the compilation
      url:
        type: string
        description: Download URL for the compilation file
      lang:
        type: array
        description: A list of wiki language codes documenting the language(s) of the articles in the compilation
        items:
          type: string
      summary:
        type: string
        description: A short description of the compilation contents
      description:
        type: string
        description: A detailed description of the compilation contents
      media:
        type: string
        enum:
          - all
          - images
          - none
      image_thumb:
        type: object
        description: Thumbnail image (320px) representing the collection
        $ref: '#/definitions/image_props'
      image_feature:
        type: object
        description: Feature-size image (640px) representing the collection
        $ref: '#/definitions/image_props'
      count:
        type: integer
        description: The number of articles included in the compilation
      size:
        type: integer
        description: The size of the compilation, in bytes
      timestamp:
        type: integer
        description: Unix timestamp for the compilation file creation
    required:
      - name
      - count
      - size
      - timestamp

  media_list:
    type: object
    properties:
      items:
        type: array
        description: a list of media items
        items:
          $ref: '#/definitions/media_item'
    required:
      - items

  media_item:
    type: object
    properties:
      title:
        type: string
        description: the prefixed DB title for the item
      type:
        type: string
        enum:
          - image
          - video
          - audio
      caption_html:
        type: string
        description: on-wiki caption for the media item, including all HTML markup
      caption_text:
        type: string
        description: plain text of the on-wiki caption for the media item
      start_time:
        type: number
        desription: start time (if any) for the media item
      end_time:
        type: number
        desription: end time (if any) for the media item
      url:
        type: string
        description: the content URL for the original item
      thumb_url:
        type: string
        description: the URL for a thumbnail of the original item
      mime:
        type: string
        description: the MIME type for the original item
      thumb_mime:
        type: string
        description: the MIME type for the thumbnail
      width:
        type: integer
        description: the original width
      height:
        type: integer
        description: the original height
      size:
        type: integer
        description: the original file size in bytes (sizes are not provided for video derivatives)
      duration:
        type: number
        description: the playback duration in seconds (for audio and video items)
      derivatives:
        type: array
        description: a list of derivatives of the original file (applies only to videos)
        items:
          type: object
      artist:
        type: string
        description: author of the media item
      credit:
        type: string
        description: source of the media item
      license:
        type: string
        description: license under which the media item is available on Wikimedia Commons
      license_url:
        type: string
        description: URL for the pertinent license
      description:
        type: string
        description: description of the image from Wikimedia Commons
    required:
      - title
      - type
      - url
      - thumb_url
      - mime
      - thumb_mime
      - width
      - height
      - size
      - license
    additionalProperties: false

  action:
    type: object
    properties:
      title:
        type: string
        description: The title to display on the button that performs the action
      url:
        type: string
        description: The URL to navigate to when the button is pressed
    required:
      - title
      - url

  empty:
    type: object
    properties:
      type:
        type: string
        description: description of original content type (buffer)
      data:
        type: array
        description: Buffer contents
        items:
          type: string
    additionalProperties: false

  titles_set:
    type: object
    properties:
      canonical:
        type: string
        description: the DB key (non-prefixed)
      normalized:
        type: string
        description: the normalized title (https://www.mediawiki.org/wiki/API:Query#Title_normalization)
      display:
        type: string
        description: the title as it should be displayed to the user
    required:
      - canonical
      - normalized
      - display
    additionalProperties: false

  content_urls:
    type: object
    properties:
      page:
        type: string
        description: the canonical page URL
      revisions:
        type: string
        description: the revision history page URL
      edit:
        type: string
        description: the (desktop) URL for editing the page
      talk:
        type: string
        description: the talk page URL, if applicable
    required:
      - page
      - revisions
      - edit
    additionalProperites: false

  api_urls:
    type: object
    properties:
      summary:
        type: string
        description: the REST API summary URL for the page
#      read_html:
#        type: string
#        description: the REST API URL for the PCS read HTML for the page (not yet active)
#      content_html:
#        type: string
#        description: the REST API URL for the PCS content HTML for the page (not yet active)
#      metadata:
#        type: string
#        description: the REST API URL for the page metadata (not yet active)
#      references:
#        type: string
#        description: the REST API URL for the references on the page (not yet active)
#      media:
#        type: string
#        description: the REST API URL for the media included in the page (not yet active)
      edit_html:
        type: string
        description: the REST API URL for the raw Parsoid HTML for the page
      talk_page_html:
        type: string
        description: the REST API URL for the raw Parsoid HTML for the talk page for this page (if applicable)
    required:
      - summary
#      - read_html
#      - content_html
#      - metadata
#      - references
#      - media
      - edit_html
    additionalProperties: false
